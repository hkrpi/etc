# Generated by iptables-save v1.4.14 on Sat Oct 11 12:28:52 2014
*filter
:INPUT DROP [393:30004]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [212:23456]
:CPSESSION - [0:0]
:INBOUND - [0:0]
:OUTBOUND - [0:0]
# Some essential stuff
-A INPUT -m state --state INVALID -j DROP
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -i lo -j ACCEPT
# DHCP client from upstream
-A INPUT -i eth0 -p udp --sport 67 --dport 68 -j ACCEPT
-A INPUT -i eth1 -p udp --sport 67 --dport 68 -j ACCEPT
# SSH server
-A INPUT -p tcp --dport 22 -j ACCEPT
# DHCP server
-A INPUT -i wlan0 -p udp --sport 68 --dport 67 -j ACCEPT
# @TODO: Proxy server ? captive portal?
#
# FORWARD Chain
#
# Essential stuff
-A FORWARD -m state --state INVALID -j DROP
-A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
# Allowed forwarding
-A FORWARD -i eth1 -o wlan0 -j INBOUND
-A FORWARD -i eth0 -o wlan0 -j INBOUND
-A FORWARD -i wlan0 -o eth1 -j OUTBOUND
-A FORWARD -i wlan0 -o eth0 -j OUTBOUND
# @TODO: DROP IF NOT FOUND IN CPSESSION
-A OUTBOUND -j CPSESSION
# Default accept for outbound traffic
-A OUTBOUND -j ACCEPT
# NO INBOUND accepted
-A INBOUND -j DROP
COMMIT
# Completed on Sat Oct 11 12:28:52 2014
# Generated by iptables-save v1.4.14 on Sat Oct 11 12:28:52 2014
*nat
:PREROUTING ACCEPT [3374:657546]
:INPUT ACCEPT [2428:245263]
:OUTPUT ACCEPT [31:2375]
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING -o eth0 -j MASQUERADE
-A POSTROUTING -o eth1 -j MASQUERADE
COMMIT
# Completed on Sat Oct 11 12:28:52 2014
